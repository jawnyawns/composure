"use strict";var $app=void 0,$editor=void 0,$caret=void 0,$modeBtn=void 0,$aboutBtnOpen=void 0,$aboutBtnClose=void 0,$autosaveLabel=void 0,$wordcountLabel=void 0,$aboutModal=void 0,caretFrame=void 0,sustainCaret=void 0,caretTimer=void 0,autosaveTimer=void 0;window.addEventListener("load",function(){$app=document.getElementById("app"),$editor=document.getElementById("editor"),$caret=document.getElementById("caret"),$modeBtn=document.getElementById("mode-btn"),$aboutBtnOpen=document.getElementById("about-modal-link"),$aboutBtnClose=document.getElementById("about-modal-close"),$autosaveLabel=document.getElementById("autosave-label"),$wordcountLabel=document.getElementById("wordcount-label"),$aboutModal=document.getElementById("about-modal"),window.addEventListener("storage",function(a){pullEditor($editor,localStorage._c_txt),pullTheme(localStorage._c_thm)}),$editor.addEventListener("input",function(a){pushLocal("_c_txt",$editor.innerText),maybeScroll($editor),cycleAutosaveLabel($autosaveLabel),updateWordcountLabel($wordcountLabel,$editor.innerText),maybeRandPlaceholder($editor)}),$editor.addEventListener("keydown",function(a){handleCmds(a),handleTabs(a),handleRets(a,$editor),showCaret($caret)}),$editor.addEventListener("keyup",function(a){return maybeEmpty($editor)}),$editor.addEventListener("paste",function(a){handlePaste(a),showCaret($caret)}),$editor.addEventListener("copy",function(a){return handleCopyOrCut(a)}),$editor.addEventListener("cut",function(a){return handleCopyOrCut(a)}),$editor.addEventListener("focus",function(a){$caret.hidden=!1,moveCaret($caret)}),$editor.addEventListener("blur",function(a){$caret.hidden=!0,cancelAnimationFrame(caretFrame)}),$editor.addEventListener("click",function(a){return showCaret($caret)}),$modeBtn.addEventListener("click",function(a){return toggleTheme()}),$aboutBtnOpen.addEventListener("click",function(a){return showAboutModal($aboutModal)}),$aboutBtnClose.addEventListener("click",function(a){return hideAboutModal($aboutModal)}),init()});var init=function(){localStorage.getItem("_c_txt")?pullEditor($editor,localStorage._c_txt):pushLocal("_c_txt",""),localStorage.getItem("_c_thm")?pullTheme(localStorage._c_thm):pushLocal("_c_thm","day"),maybeEmpty($editor),$app.hidden=!1,$editor.focus(),blinkCaret($caret),sustainCaret=!1,$autosaveLabel.innerText="SAVED "+time12(),updateWordcountLabel($wordcountLabel,$editor.innerText),maybeRandPlaceholder($editor),updateMetaThemeColor(localStorage._c_thm)},pushLocal=function(b,c){return localStorage.setItem(b,c)},pullTheme=function(b){document.body.className=b,"day"==b?$modeBtn.innerHTML="NIGHT MODE":$modeBtn.innerHTML="DAY MODE"},pullEditor=function(b,c){b.innerText=c,normalizeLinebreaks(b.innerText)},moveCaret=function a(){$caret.style.left=getCaretCoords($editor).x-2+"px",$caret.style.top=getCaretCoords($editor).y-8+"px",""==document.getSelection().toString()?$caret.hidden=!1:$caret.hidden=!0,caretFrame=requestAnimationFrame(a)},blinkCaret=function(b){setInterval(function(){b.hidden||sustainCaret||(1==b.style.opacity?b.style.opacity=0:b.style.opacity=1)},570)},showCaret=function(b){b.style.opacity=1,sustainCaret=!0,null!=caretTimer&&clearTimeout(caretTimer),caretTimer=setTimeout(function(){return sustainCaret=!1},570)},cycleAutosaveLabel=function(b){null!=autosaveTimer&&clearTimeout(autosaveTimer),autosaveTimer=setTimeout(function(){b.innerText="SAVING...",b.style.fontStyle="italic",setTimeout(function(){b.innerText="SAVED "+time12(),b.style.fontStyle="normal"},1200)},650)},updateWordcountLabel=function(b,c){var d=c.trim().split(/\s+/).length;""==c&&(d=0),b.innerText=d+" WORDS"},maybeRandPlaceholder=function(b){if(""==b.innerText){var c=["And so it begins...","Happy typing...","It was a dark and stormy night...","Once upon a time...","It was the best of times, it was the worst of times...","It was all just a dream..."];b.dataset.placeholder=c[getRandomIntInclusive(0,c.length-1)]}},handleCmds=function(b){var c=b.keyCode;if(!(c<65||c>90)){var d=(b.metaKey?"⌘":"")+String.fromCharCode(c);switch(d){case"⌘B":b.preventDefault();break;case"⌘I":b.preventDefault()}}},toggleTheme=function(){"day"==document.body.className?(document.body.className="night",$modeBtn.innerHTML="DAY MODE",pushLocal("_c_thm","night")):(document.body.className="day",$modeBtn.innerHTML="NIGHT MODE",pushLocal("_c_thm","day")),$editor.dataset.placeholder="Oohhh... "+localStorage._c_thm+" mode!",updateMetaThemeColor(localStorage._c_thm)},handleTabs=function(b){9===b.keyCode&&(b.preventDefault(),document.execCommand("insertText",!1,"     "))},handleRets=function(b,c){13===b.keyCode&&""==c.innerHTML&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(b.preventDefault(),document.execCommand("insertHTML",!1,"<br><br>"))},handlePaste=function(b){b.preventDefault();var c=(b.originalEvent||b).clipboardData.getData("text/plain");document.execCommand("insertText",!1,c),normalizeLinebreaks($editor.innerText)},handleCopyOrCut=function(b){var c=(b.originalEvent||b).clipboardData.getData("text/plain");b.clipboardData.setData("text/plain",c)},normalizeLinebreaks=function(b){for(var c=b.split(""),d=0;d<c.length;d++)"\\"===c[d]&&"n"===c[d+1]&&(c[d]="<b",c[d+1]="r>");return c.join()},maybeEmpty=function(b){"<br><br>"!=b.innerText&&"\n"!=b.innerText||(b.innerText="")},maybeScroll=function(b){getCaretIndex(b)>=b.textContent.length&&scrollTo(0,document.body.scrollHeight)},showAboutModal=function(b){return b.hidden=!1},hideAboutModal=function(b){return b.hidden=!0},getRandomIntInclusive=function(b,c){return b=Math.ceil(b),c=Math.floor(c),Math.floor(Math.random()*(c-b+1))+b},time12=function(){var b=new Date,c=b.getHours(),d=b.getMinutes(),e=c>=12?"PM":"AM";return c%=12,c=c?c:12,d=d<10?"0"+d:d,c+":"+d+e},updateMetaThemeColor=function(b){var c=void 0;"day"==b?c="#f7f7f6":"night"==b&&(c="#1a1a19"),document.querySelector("meta[name=theme-color]").remove();var d=document.createElement("meta");d.name="theme-color",d.content=c,document.getElementsByTagName("head")[0].appendChild(d)},getCaretIndex=function(b){var c=0;if("undefined"!=typeof window.getSelection){var d=window.getSelection().getRangeAt(0),e=d.cloneRange();e.selectNodeContents(b),e.setEnd(d.endContainer,d.endOffset),c=e.toString().length}else if("undefined"!=typeof document.selection&&"Control"!=document.selection.type){var f=document.selection.createRange(),g=document.body.createTextRange();g.moveToElementText(b),g.setEndPoint("EndToEnd",f),c=g.text.length}return c},getCaretCoords=function(b){var c=document.selection,d=void 0,e=void 0,f=0,g=0;if(c)"Control"!=c.type&&(d=c.createRange(),d.collapse(!0),f=d.boundingLeft,g=d.boundingTop);else if(window.getSelection&&(c=window.getSelection(),c.rangeCount&&(d=c.getRangeAt(0).cloneRange(),d.getClientRects&&""!=b.innerText&&(d.collapse(!0),d.getClientRects().length>0&&(e=d.getClientRects()[0],f=e.left,g=e.top)),0==f&&0==g))){var h=document.createElement("span");if(h.getClientRects){h.appendChild(document.createTextNode("​")),d.insertNode(h),e=h.getClientRects()[0],f=e.left,g=e.top;var i=h.parentNode;i.removeChild(h),i.normalize()}}return{x:f,y:g}};
